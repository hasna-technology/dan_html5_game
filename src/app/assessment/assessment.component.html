<div class="assess  {{ref_name}}" id="assessment_{{id}}">
  <div class="number_group" [ngClass]="{'blur' : panel == true}">
    <div class="top_panel">
      <p class="font-thin mb-0" [innerHTML]="getContent(ref_arr.title)"></p>
    </div>
    <img class="full-width" src="{{ref_arr.image}}">
    <div>
      <!-- Number -->
      <div class="poitner" *ngFor="let q of ref_arr.quiz; let i = index" >
        <img class="pointer_img" src="assets/image/pointer.png" alt=""><br>
        <button class="number" [ngClass]="{ 'blink': !q.submitted, 'bg-green' : q.submitted}" (click)="onclick(q)"
          [ngStyle]="{'border-color': ref_arr.quiz[i].userchoice == undefined ? '#FF0000' : '#00FF00'}">
          {{q.id}}
        </button>

        <div id="popup" class="popup" [@fallIn] *ngIf="(selected_quiz == q && q.showPopup == true) || show_result == true">
          <div class="question" [innerHTML]="getContent(q.question)" [ngClass]="{
                'correct' : q.userchoice != undefined && q.choices[q.userchoice].correct == true && show_result == true,
                'incorrect' : q.userchoice != undefined && q.choices[q.userchoice].correct != true && show_result == true
          }">
          </div>
          <div class="answer">

            <div class="choice" *ngFor="let choice of q.choices; let i = index"
              [ngClass]="{'disable' : ref_arr.completed == true}" (click)="choiceClick(q, i)">
              <div class="eval" *ngIf="q.userchoice === i && show_result == true"
                [ngClass]="{'correct' : choice.correct == true}">
                <img src="{{ choice.correct == true ? 'assets/image/tick.png' :  'assets/image/wrong.png'}}" alt="">
              </div>
              <div class="square_radio">
                <div [ngClass]="{
                              'tick': q.userchoice != i && choice.correct == true && show_result == true , 
                              'wrong': q.userchoice != i && choice.correct == false && show_result == true, 
                              'circle' : q.userchoice === i }">

                </div>
              </div>
              <!-- <input type="radio" name="choice" [checked]="q.userchoice === i" (change)="q.userchoice = i" id="{{i}}"> -->
              <span [innerHTML]="getContent(choice.text)"></span>
            </div>
          </div>
          <div class="footer">
            <div class="button btn small-outliner" *ngIf="q.userchoice != undefined && ref_arr.completed != true"
              (click)="  onSubmit();">
              {{service._content['submit']}}
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--     -->
    <div class='next_panel text-center' *ngIf="ref_arr.completed">
      <!--*ngIf="nextEnable"-->
      <button type="button" class="btn btn-primary btn-width rounded-pill next uppercase" (click)="onNext()">{{service._content['next']}}</button> <br>
      <button class="btn btn-light rounded-pill btn-width btn-answer font-light"
        (click)="toggleAnswer()">{{show_result ? service._content['hide'] : service._content['show']}}</button>
    </div>
    <div class="bottom_bar">
      <div class="d-flex flex-row">
        <div class="d-flex flex-col">
          <div class="title">{{service._content['refrigerant_title']}}</div>
          <div class="content">{{ref_name == 'mbp' ? service._content['cr'] : service._content['fr']}}</div>
        </div>
        <div class="d-flex flex-col">
          <div class="score" *ngIf="ref_arr.completed">{{service._content['your_score']}}: <span class='user-score'>{{ref_arr.score}}</span> out
            of
            {{ref_arr.total}}</div>
        </div>
        <div class="d-flex flex-col">
          <div class="title">{{service._content['refrigerant']}}</div>
          <div class="content">{{ref_arr.name}}</div>
          <div class="icon"><img src="assets/image/refrigerant_Icon.png" alt=""></div>

          <div class="title">{{service._content['temp']}}</div>
          <div class="content">{{ref_name == 'mbp' ? '5째C / 40째F' : '-18째C / 0째F'}}</div>
          <div class="icon"><img src="assets/image/temperature_icon.png" alt=""></div>
        </div>
      </div>
    </div>
  </div>


  <div class="dark_bg" *ngIf="panel==true" >
    <div class="panel " [@fallIn]>

      <div class="step_1 text-center" *ngIf="step == 1" [@fallIn]>
        <button class="btn btn-red rounded-pill next-challenge" routerLink="/home/1">{{service._content['challenge']}}</button><br><br>
        <button class="btn btn-outline-secondary rounded-pill nothanks" (click)="step = 2; getScore();">{{service._content['no_thanks']}}
          </button>
      </div>

      <div class="yourscore_panel font-light text-center step_2" *ngIf="step == 2" [@fallIn]>
        <h1 class="font-thin biggest-font">{{service._content['your_score']}}</h1>
        <div class="border-box">
          <div class="box ">
            <div class="row">
              <div class="col-sm-5">
                <div class="row">
                  <div class="col-12 table_header border-box">
                    {{service._content['cold_room_score']}}
                  </div>
                </div>
                <div class="margin-row">
                  <div class="border-box ">

                    <div class="row " *ngFor="let item of mbp">
                      <div class="col-6 ">{{item.name}}</div>
                      <div class="col-6 ">{{item.score}}</div>
                    </div>
                  </div>
                  <div class="border-box  mt-2 ">
                    <div class="row font-bold ">
                      <div class="col-6 "><b>{{service._content['total']}}</b></div>
                      <div class="col-6 "><b>{{mbp_score}}</b></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-sm-2"></div>
              <div class="col-sm-5">
                <div class="row">
                  <div class="col-12 table_header border-box">
                    {{service._content['freezer_room_score']}}
                  </div>
                </div>
                <div class="margin-row">
                  <div class="border-box ">

                    <div class="row " *ngFor="let item of lbp">
                      <div class="col-6 ">{{item.name}}</div>
                      <div class="col-6 ">{{item.score}}</div>
                    </div>
                    <div class="row " *ngFor="let item of lbp">
                      <div class="col-6 ">&nbsp;</div>
                      <div class="col-6 ">&nbsp;</div>
                    </div>
                  </div>
                  <div class="border-box  mt-2 ">
                    <div class="row font-bold ">
                      <div class="col-6 "><b>{{service._content['total']}}</b></div>
                      <div class="col-6 "><b>{{lbp_score}}</b></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <p class="mt-4 font-small"><b>{{service._content['total_all']}}<span class='big_header'>{{totalScore}}</span></b>{{service._content['out']}}
              {{total}}
            </p>
            <p class="mt-3 font-small">{{service._content['wishes']}}</p>
            <button (click) = "playAgain()"
              class="btn btn-red rounded-pill mb-3 playagain font-light">{{service._content['play_again']}}</button><br>
            <!--<button routerLink="/wall" class="btn btn-red rounded-pill font-14 font-light mb-3">Send my result to Wall
              of
              Fame</button>-->
          </div>
        </div>

        <h1 class="font-thin biggest-font mt-3">{{service._content['result']}}</h1>
        <div class="border-box">
          <div class="m-4 font-small font-normal">
            <form class="nameForm" [formGroup]="angForm" novalidate (ngSubmit)="onFormSubmit()">
              <div class="single-row">
                <div class="lable">
                    <label for="username" class="col-form-label">{{service._content['nick_name']}}</label>
                </div>
                <div class="field">
                    <input type="text" class="form-control" placeholder="{{service._content['nick_name']}}" formControlName="username">
                    <div *ngIf="submitted && angForm.controls['username'].invalid" class="error">
                      <div *ngIf="angForm.controls['username'].errors.required">Name is required.</div>
                    </div>
                </div>
              </div>
              <div class="single-row">
                <div class="lable">
                    <label for="country" class="col-form-label">{{service._content['country']}}</label>
                </div>
                <div class="field">
                  <select type="number" class="form-control custom-select-mb" formControlName="country">
                    <option value='0'>{{service._content['select_country']}}</option>
                    <option *ngFor="let country of countries" value='{{country.code}}'>{{country.name}}</option>
                  </select>
                </div>
              </div>
              <div class="single-row mt-3">
                <div class="lable"></div>
                <div class="field">
                  <input type="submit" [disabled]="!(angForm.valid && angForm.controls['country'].value != 0)" value="{{service._content['submit']}}" 
                  class="btn btn-red rounded-pill playagain font-light">
                </div>
              </div>
            </form>
          </div>
        </div>
      
      </div>
    </div>



    <!-- <input type="button" class="btn next-button " routerLink="/form" value="Form"> -->
  </div>
